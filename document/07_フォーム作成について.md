# 【フォーム作成手順】

## 1.モデルの作成(models.py)
```
from django.db import models
from django.core.validators import FileExtensionValidator, MinValueValidator, MaxValueValidator

class HouseModel(models.Model):
	testfile = models.FileField(validators=[FileExtensionValidator(['csv'])])
	area = models.IntegerField(validators=[MinValueValidator(0), MaxValueValidator(9999)])
	distance = models.IntegerField(validators=[MinValueValidator(0), MaxValueValidator(99999)])
```

## 2.フォームの作成(forms.py)
```
from django import forms
from .models import HouseModel

class HouseDateForm(forms.ModelForm):
	class Meta:
		model = HouseModel
		fields = ['testfile', 'area', 'distance']
		widgets = {
			'testfile': forms.FileInput(attrs={'class':'form-control'}),
			'area': forms.NumberInput(attrs={'class':'form-control'}),
			'distance': forms.NumberInput(attrs={'class':'form-control'}),
		}
```

## 3.フォームをコントローラに渡す(views.py)
```
def house(request):
		[省略...]
		form = HouseDateForm(request.POST, request.FILES)
	else:
        [省略...]
        form = HouseDateForm()
	params = {
		'title' : '住宅価格(モデルデータセット)',
		'form' : form,
        [省略...]
	}
	return render(request, 'house.html', params)
```

## 4.フォームをビューに表示
```
<form action="{% url 'house' %}" method="post" enctype="multipart/form-data" class="col-6">
	<h6 class="text-danger">{{errormsg}}</h6>
	{% csrf_token %}  ←【必ず必要】
	<div class="mb-4">
		<label class="form-label">賃貸価格データ(csv)</label>
		{{ form.testfile }}
	</div>
	<div class="mb-4">
		<label class="form-label">賃貸の広さ(㎡)</label>
		{{ form.area }}
	</div>
	<div class="mb-4">
		<label class="form-label">駅からの距離(m)</label>
		{{ form.distance }}
	</div>
	<br>
	<input type="submit" value="{{submit}}" class="btn btn-primary click-btn">
</form> 
```

## imageやcsvなどのファイルを送る際の設定方法

### setting.py(プロジェクト内)
```
import os #追加

MEDIA_URL = '/media/'
MEDIA_ROOT = os.path.join(BASE_DIR, 'media')
```

### urls.py(プロジェクト内)
```
from django.conf import settings #追加
from django.conf.urls.static import static #追加

if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
```

### xxx.html(アプリ内Templates)
  - enctype=“multipart/form-data”の記載が必要
```
<form method=“POST” enctype=“multipart/form-data”>
    {% csrf_token %}
    <input type=“file” name=“testfile”>
    <button type=“submit”>アップロード</button>
</form>
```